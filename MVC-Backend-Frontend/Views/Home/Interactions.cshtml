@page

<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Code Craft</title>
  <style>
    #checkmark {
      top: 50%;
      transform: translate(1150%, -70%);
      width: 100px;
      position: relative;
      y
    }

    .wrong-answer-message {
      top: 50%;
      transform: translate(325%, -70%);
      width: 120px;
      font-size: 32px !important;
      white-space: nowrap;
      overflow: visible;
      width: auto;
      text-overflow: clip;
    }
  </style>
</head>

<body>
  <!--<button id="test-button">Test</button>-->
  <div id="mainContainer">
    <nav class="collapse d-lg-block sidebar left-sidebar-menu consistent-header-parent">
      <h5 class=" consistent-header full-width">Tasks</h5>
      <button class="tasks-button padding-10" onclick="openTasksModal()">Select a task</button>
      <br>
      <h5 class="consistent-header full-width fixed-header">
        Code Blocks
      </h5>

      <!--Start of the sidebar element-->
      <div class="card-container">
        <div class="card">
          <div class="card-header" id="headingOne" class="btn btn-link collapsed" data-bs-toggle="collapse"
            data-bs-target="#collapseOne" title="Variables are used to store information.">
            <h5 class="mb-0">
              <button class="btn btn-link collapsed">
                Variables
              </button>
              <button id="downarrow" class="btn btn-link collapsed">
                ▼
              </button>
            </h5>
          </div>
          <div class="collapse" id="collapse">
            <div id="errorcontainer"></div>

          </div>
          <div id="collapseOne" class="collapse" aria-labelledby="headingOne" data-bs-parent="#accordion">
            <div class="card-body" id="variableContainer" ondrop="drop(event)" ondragover="allowDrop(event)">
              <div style="background-color:#e87a7a" class="card card-body" id="createvariable">
                <h3>Create a variable</h3>
                <input type="text" placeholder="Input name of Variable" name="name" id="textInput"></input>
                <select id="selectType" name="type" aria-placeholder="Type">
                </select>
                <input type="text" id="valueInput" placeholder="Input value of Variable"></input>
                <a class="btn btn-primary" id="createbutton">
                  Create Variable
                </a>
              </div>
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header" id="headingTwo" class="btn btn-link collapsed" data-bs-toggle="collapse"
            data-bs-target="#collapseTwo" title="Logic contains logical operators.">
            <h5 class="mb-0">
              <button class="btn btn-link collapsed">
                Logic
              </button>
              <button id="downarrow" class="btn btn-link collapsed">
                ▼
              </button>
            </h5>
          </div>
          <div id="collapseTwo" class="collapse" aria-labelledby="headingTwo" data-bs-parent="#accordion">
            <div class="card-body" id="logicContainer">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header" id="headingThree" class="btn btn-link collapsed" data-bs-toggle="collapse"
            data-bs-target="#collapseThree" title="Math contains basic mathematical operators.">
            <h5 class="mb-0">
              <button class="btn btn-link collapsed">
                Math
              </button>
              <button id="downarrow" class="btn btn-link collapsed">
                ▼
              </button>
            </h5>
          </div>
          <div id="collapseThree" class="collapse" aria-labelledby="headingThree" data-bs-parent="#accordion">
            <div class="card-body" id="expressionContainer"></div>
          </div>
        </div>


        <div class="card">
          <div class="card-header" id="headingFour" class="btn btn-link collapsed" data-bs-toggle="collapse"
            data-bs-target="#collapseFour" title="Functions contains pre-defined functions.">
            <h5 class="mb-0">
              <button class="btn btn-link collapsed">
                Functions
              </button>
              <button id="downarrow" class="btn btn-link collapsed">
                ▼
              </button>
            </h5>
          </div>
          <div id="collapseFour" class="collapse" aria-labelledby="headingFour" data-bs-parent="#accordion">
            <div class="card-body" id="functionContainer">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header" id="headingFive" class="btn btn-link collapsed" data-bs-toggle="collapse"
            data-bs-target="#collapseFive" title="Scope contains if conditions and loops.">
            <h5 class="mb-0">
              <button class="btn btn-link collapsed">
                Scope
              </button>
              <button id="downarrow" class="btn btn-link collapsed">
                ▼
              </button>
            </h5>
          </div>
          <div id="collapseFive" class="collapse" aria-labelledby="headingFive" data-bs-parent="#accordion">
            <div class="card-body" id="scopeContainer">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header" id="headingSix" class="btn btn-link collapsed" data-bs-toggle="collapse"
            data-bs-target="#collapseSix" title="Equality contains comparison blocks.">
            <h5 class="mb-0">
              <button class="btn btn-link collapsed">
                Equality
              </button>
              <button id="downarrow" class="btn btn-link collapsed">
                ▼
              </button>
            </h5>
          </div>
          <div id="collapseSix" class="collapse" aria-labelledby="headingSix" data-bs-parent="#accordion">
            <div class="card-body" id="equalityContainer">
            </div>
          </div>
        </div>

        <div class="card">
          <div class="card-header" id="headingSeven" class="btn btn-link collapsed" data-bs-toggle="collapse"
            data-bs-target="#collapseSeven" title="Assignment contains ways to assign values.">
            <h5 class="mb-0">
              <button class="btn btn-link collapsed">
                Assignment
              </button>
              <button id="downarrow" class="btn btn-link collapsed">
                ▼
              </button>
            </h5>
          </div>
          <div id="collapseSeven" class="collapse" aria-labelledby="headingSeven" data-bs-parent="#accordion">
            <div class="card-body" id="assignmentContainer">
            </div>
          </div>
        </div>
      </div>

    </nav>

    <div class="consistent-header-parent">
      <div class="task-description">
        <h5 class="consistent-header">
          Task Description
        </h5>
        <div class="description-of-selected-task">Currently no task selected</div>
      </div>
      <div class="content-wrapper">
        <h5 class="consistent-header">
          Code Editor
        </h5>

        <div class="tab-headers">
          <div hidden class="tab active" data-tab-id="1">
            <span class="tab-title">Tab 1</span>
            <button class="close-tab">x</button>
          </div>
          <!-- Dynamically added tabs will appear here -->
          @* <button id="addTab">+</button> *@
          <button id="run-button" onclick="taskRunner()">Run</button>

        </div>

        <!-- Tab content -->
        <div class="tab-contents">
          <br><br>
          <div class="tab-content active testContainer2 line-container" id="code-container" data-tab-id="1">
            @* Content for Tab 1 *@
            <div class="checkmark-image"></div>
            <div class="wrong-answer-message"></div>
          </div>
          <!-- Dynamically added tab contents will appear here -->

        </div>

        <div class="trash-container">
          <img src="~/images/trash.png" alt="trash" class="trash-image" id="trash" ondrop="deleteDrop(event)"
            ondragover="allowDrop(event)">
          <div id="trash-container" class="trash-container"></div>
        </div>



        <div class="consistent-header-parent console-container">
          <h5 class="consistent-header">
            Console Output
          </h5>
          <div class="console-content">
            <textarea readonly id="console-textarea" rows="7" oninput="updateConsoleOutput(this.value)"></textarea>
            <div class="console-error-line"></div>
          </div>
        </div>
      </div>
    </div>

    <div id="tasksContainer">
      <partial name="TasksModal" />
    </div>
  </div>
  <script>
    let answerIsCorrect = false;
    let consoleOutput = "";
    let answer = "hello world"; // for question 1
    const checkmarkImage = document.getElementById('checkmark');
    const checkmarkContainer = document.querySelector('.checkmark-image');
    const incorrectAnswerMessageContainer = document.querySelector('.wrong-answer-message');

    function taskRunner() {
      document.getElementById('.console-textarea').textContent = "Correct";
    }

    function updateConsoleOutput(value) {
      consoleOutput = value;
      

      // Update the height of the textarea based on the content
      const textarea = document.getElementById('console-textarea');
      textarea.style.height = 'auto';
      textarea.style.height = textarea.scrollHeight + 'px';

      
      

      if (document.getElementsByClassName("description-of-selected-task").value !== "Currently no task selected") {
        consoleOutput = "Incorrect";
        document.getElementById('console-textarea') = "Incorrect";
        const textarea = document.getElementById('console-textarea');
        textarea.style.height = 'auto';
        textarea.style.height = textarea.scrollHeight + 'px';
      }
    }

    function checkAnswer() {
      
      
      

      if (consoleOutput.trim() === answer) {
        answerIsCorrect = true;
      } else {
        answerIsCorrect = false;
      }

      

      if (answerIsCorrect) {
        incorrectAnswerMessageContainer.innerHTML = '';
        checkmarkContainer.innerHTML = '<img src="/images/checkMark.png" alt="check mark image" id="checkmark">';
        
      } else {
        // Clear previous content in checkmarkContainer
        checkmarkContainer.innerHTML = '';

        incorrectAnswerMessageContainer.innerHTML = 'Oops! Let us try again :) ';
      }
    }


    window.onload = function () {
      function openTasksModal() {
        $('#tasksModal').modal('show');
      }

      function closeModal() {
        document.querySelector('.modal-overlay').style.display = 'none';
        document.getElementById('tasksModal').style.display = 'none';
      }

      document.querySelector('.modal-overlay').addEventListener('click', function () {
        closeModal();
      });

      tasksContainer.Visible = false;

      openTasksModal_ServerClick = function () {
        tasksContainer.Visible = true;
      };
    };
  </script>

  <dialog id="confirmDelete">
    <form method="dialog">
      <p>Are you sure you want to delete this?</p>
      <div class="dialogButtonContainer">
        <button value="Yes" formmethod="dialog" id="deleteButton">Delete</button>
        <button value="No" formmethod="dialog">Cancel</button>
      </div>
    </form>
  </dialog>

  <dialog id="okDialog">
    <form method="dialog">
      <p id=okDialogMessage></p>
      <div class="dialogButtonContainer">
        <button value="Ok" formmethod="dialog">Ok</button>
      </div>
    </form>
  </dialog>

  <dialog id=openDialog>
    <form method="dialog">
      <div id="openDialogList"></div>
      <div class="dialogButtonContainer">
        <button value="Ok" formmethod="dialog">Ok</button>
      </div>
    </form>
  </dialog>

  <dialog id="saveDialog">
    <form method="dialog">
      <p>Enter a name for your file</p>
      <input type="text" id="saveDialogInput" placeholder="Enter a name for your file"></input>
      <div class="dialogButtonContainer">
        <button value="Save" formmethod="dialog" id="saveButton">Save</button>
        <button value="Cancel" formmethod="dialog">Cancel</button>
      </div>
    </form>
  </dialog>


  <script type="module" defer src="~/js/testing.js"></script>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <script type="module" src="~/js/tabs.js"></script>
  <script type="module" src="~/js/dropdown.js"></script>
  <script src="~/js/kodeFiles.js"></script>
  <script>document.addEventListener('DOMContentLoaded', function () {
      document.body.style.overflow = 'hidden';
      document.documentElement.style.overflow = 'hidden';
    });
  </script>
</body>

</html>
